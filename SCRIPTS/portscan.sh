#!/bin/bash
#Port knocking
#script com "hping3 -S --faster -p $port -c 1 $host" batendo nas portas 13, 37, 30000, 3000, 1337
if test -z $1;
then
  echo "##############################################"
  echo "### Passe o IP e range, ex: 192.168.0.1 24 ###"
  echo "##############################################"
  exit 0
fi

ip=$1 | awk -F '.' '{print $1"."$2"."$3}'
host=$1 | awk -F '.' '{print $4}'
range=$2
list_port=(13 37 30000 3000)

while [ ${host} -le ${range} ];
do
  for port in ${list_port[@]};
  do
    hping3 -S --faster -p ${port} -c 1 ${ip}.${host} 2> /dev/null
  done
  #curl http://${ip}.${host}:1337/ >> result.txt
  #host=(expr ${host} + 1 )
done

echo "----------------------------------RESULTADOS-----------------------------"
cat -n result.txt
rm result.txt
